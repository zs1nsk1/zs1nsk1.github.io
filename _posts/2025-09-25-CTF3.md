---
title: Enumeration - CTF
date: 2025-09-24 12:10:12 +/-TTTT
categories: [INE, Ejptv2]
tags: [Nmap, Metasploit, Hydra, enum4linux, smbclient, smbmap]     # TAG names should always be lowercase


description: Below is the enumeration methodology applied for each flag.

#toc: false
---

![img-description](/assets/img/Posts/ine.png)



## CTF Solved: Deep Enumeration to Capture Hidden Flags
Enumeration is the most critical phase of any penetration test. It's not just about finding open ports; it’s about extracting detailed information from those services to uncover users, shared resources, and weak configurations. In this CTF, a methodical approach to SMB (Samba), FTP, and SSH services was the key to success.

Below is the enumeration methodology applied for each flag.

---
### 1. SMB Misconfiguration: Anonymous Access (Flag 1)
The SMB (Samba) service is the primary target when enumerating file shares.

Step 1: Hidden Share Discovery.
While automated tools (`enum4linux -a` or `smbclient -L`) didn't immediately reveal an anonymous share, the hint indicated one existed. This forced us into a more aggressive technique: Share Brute-Forcing.

Key Technique: We used a shell script or a `smbclient` loop with a wordlist (`shares.txt`) to test anonymous access for every possible share name.

The Discovery: The `pubfiles` share allowed anonymous connection. Once inside (`smbclient //target.ine.local/pubfiles -N`), the first flag (`flag1.txt`) was easily found.

Lesson: Never rely solely on passive enumeration; sometimes, you have to actively search for configuration flaws.

---
### 2. Weak Accounts: The Danger of Simple Passwords (Flag 2)
The second flag focused on the system’s credential management.

Step 1: SMB User Enumeration.
We used `enum4linux` to list valid users on the system (e.g., `josh, nancy, bob`).

Step 2: Credential Brute-Force Attack.
The hint pointed to a weak password. We used Metasploit's `smb_login` module (or Hydra) with the user list and a common password dictionary (`unix_passwords.txt`).

The Discovery: We identified a valid credential pair (e.g., `josh:purple`). The hint also suggested the user's private folder had the same name.

The Action: We accessed the private share (`smbclient //target.ine.local/josh -U josh` and found the second flag.

Lesson: Password brute-forcing is highly effective against accounts using weak or dictionary passwords.

---
### 3. Blind Enumeration and Credential Reuse (Flag 3)
The third flag required a deeper, more exhaustive scan to find hidden services, followed by applying the same brute-force technique.

Step 1: Hidden Port Discovery.
Reviewing the result from the previous flag revealed a subtle clue about an FTP service running on a non-standard port (e.g., 5554). A full port scan (`nmap -p-`) confirmed this service.

Step 2: FTP Enumeration and Brute-Force.
Attempting an FTP connection showed the service banner, which revealed more usernames. We repeated the brute-force process using Hydra (`-L users.txt -P unix_passwords.txt ftp://target:5554`) to get a new set of credentials.

The Action: Once authenticated with the compromised credentials (e.g., `alice:pretty`), the third flag was downloaded from the FTP directory.

Lesson: Full port range scanning and analyzing service banners are essential to uncovering backdoors and non-standard setups.

---
### 4. Warning Banners: A Message in Plain Sight (Flag 4)
The final hint suggested the flag was contained within a warning message for unauthorized users.

Key Technique: SSH Banner Grabbing (MOTD).

The Discovery: The only remaining service we hadn't fully analyzed was SSH (port 22). By simply attempting to connect (`ssh target.ine.local`), the system displayed the "Message of the Day" (MOTD) or warning banner before asking for credentials.

The Action: This welcome message contained the fourth and final flag.

Lesson: Service welcome messages (banners) are an often-overlooked source of enumeration information and can even contain sensitive data or, in this case, the CTF flags!

---
### In Summary:

This CTF highlighted the importance of:

- Not trusting default service configurations (SMB).

- Using brute-force tools (Metasploit/Hydra) against weak credentials.

- Performing full port scans (`-p-`) to avoid missing services on non-standard ports.

- Paying close attention to service banners and welcome messages.