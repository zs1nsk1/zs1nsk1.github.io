---
title: System-Host Based Attacks - CTF 1
date: 2025-09-26 12:10:12 +/-TTTT
categories: [INE, Ejptv2]
tags: [Nmap, Webdav, Davtest, Cadaver, Hydra, Smb]     # TAG names should always be lowercase


description: Privilege Escalation and Persistence in Host-Based Attacks.

#toc: false
---

![img-description](/assets/img/Posts/ine.png)



## CTF Solved: Host Penetration and Exploiting Web/SMB Services
This System-Host Based Attacks lab (common in INE/eJPT prep) focuses on common network infrastructure vulnerabilities: weak authentication on web services (IIS/WebDAV) and insecure shared resource configurations (SMB). This challenge forces us to think in terms of credential enumeration, lateral movement, and permission management.

First things first, this lab has 2 machine, so we will first exploit machine1 and then work our way to machine2:
- target1.ine.local
- target2.ine.local 

---
### Flag 1: User ‘bob’ might not have chosen a strong password. Try common passwords to gain access to the server where the flag is located. (target1.ine.local)

The first objective was to secure a foothold on a Windows Server running Microsoft IIS. The vulnerability here was weak authentication.

Vulnerability: The HTTP/80 service exposed a login portal, signaling a failure in credential management.

Exploitation: Given the hint for the user `'bob'`, we used Hydra for an `HTTP-GET` brute-force attack, employing a dictionary of common passwords (`unix_passwords.txt`).

Result: We successfully obtained `bob's` credentials, granting us access to the web portal. The first flag (Flag 1) wasn't in the application itself, but in an obvious file (`flag1.txt`) left in the root or a sensitive subdirectory, found via Directory Brute-Forcing (DirBusting).


---
### Flag 2: Valuable files are often on the C: drive. Explore it thoroughly. (target1.ine.local)

To pivot from web access to a system command shell, we exploited the misconfiguration of WebDAV, an IIS extension for remote file administration.

Vulnerability: The WebDAV feature was enabled and, critically, allowed the upload of executable files using `bob's` credentials.

Exploitation: We used `davtest` to validate which file types we could upload (e.g., `.asp`, `.aspx`). We then chose an ASPX webshell compatible with the Windows environment.

We uploaded the webshell via `davtest` (or `cadaver`) and accessed it through the browser, establishing a Command Shell on the server.

Result: With the remote shell, we could execute OS-level commands. By inspecting the local drive (the `C:` drive), we found and extracted the second flag (Flag 2) using `type C:\flag2.txt`.

---
### Flag 3: By attempting to guess SMB user credentials, you may uncover important information that could lead you to the next flag. (target2.ine.local)

Vulnerability: The SMB/445 service allowed unlimited login attempts, indicating a lack of account lockout policies.

Exploitation: We used Hydra again to brute-force the SMB service. While multiple accounts were found, the high-value target was the Administrator account.

Share Access: Using the Administrator credentials, we utilized smbclient to list the shared resources (-L) and, crucially, access administrative shares.

`smbclient -L \\\\<target> -U administrator`

#connect to a specific share
`smbclient \\\\<target>\\<shares> -U administrator`

Result: Accessing the main administrative drive share—the C$ share—allowed us to browse the entire system's file structure. We downloaded the third flag (Flag 3) found within the shared resource.

```bash
smbclient \\\\<target>\\C$ -U administrator
>dir 
>download flag3.txt
>exit

#terminal
cat flag3.txt
```

---
### Flag 4: The Desktop directory might have what you’re looking for. Enumerate its contents. (target2.ine.local)
The final post-exploitation step on this host focused on enumerating the Administrator's Desktop, a common location for carelessly stored sensitive text files.

Vulnerability: The `Administrator's` personal folders are a high-value target.

Exploitation: Using `smbclient` and still connected to the `C$` share, we navigated directly to the Administrator's desktop: `cd Users\Administrator\Desktop`.

Result: The fourth flag (Flag 4) was found and downloaded there, completing the compromise of the second machine.

```bash
cd Users\Administrator\Desktop
dir
get flag4.txt
exit

#terminal
cat flag4.txt
```

---
### Key Takeaways from the Lab
This CTF clearly illustrates the logical progression of a network penetration test:

- Weak Credentials: Always the fastest route to access. A good penetration tester must prioritize brute-forcing credentials on exposed services.

- Misconfigured Services: Enabling WebDAV and setting lax permissions on SMB open massive doors to webshells and administrative share access (C$).

- Enumeration of Known Paths: Log files, administrator Desktop directories, and root directories are primary targets when searching for secrets.
