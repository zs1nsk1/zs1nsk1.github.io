---
title: Exploitation - CTF
date: 2025-09-28 12:10:12 +/-TTTT
categories: [INE, Ejptv2]
tags: [Nmap, Searchsploit, Metasploit, Hydra, Wordpress, Nikto, Gobuster, SSH]     # TAG names should always be lowercase


description: This INE lab was a practical deep dive into three high-frequency attack vectors.

#toc: false
---

![img-description](/assets/img/Posts/ine.png)



## CTF Solved: Exploitation CTF  - From Insecure CMS to Free Access Accounts
This INE lab was a practical deep dive into three high-frequency attack vectors: Remote Code Execution (RCE) on a CMS, SSH brute-forcing, and the exploitation of malicious WordPress plugins that reveal weak credentials. The main takeaway is that security failures are often a result of unpatched third-party software and poor default account management.

Host 1: Authenticated Exploitation and Credential Failure (target1.ine.local)

The first objective focused on securing initial access by exploiting a CMS that was vulnerable to RCE, even with limited access.

---
### 1. RCE on Flatcore CMS (Flag 1)

Reconnaissance: We identified the Flatcore CMS running on the web server (Port 80) with a login form. We were provided with the credentials (`admin:password1`).

Exploitation: The key was performing a manual search with `searchsploit`, which uncovered an Authenticated Remote Code Execution (`RCE`) Python exploit for the CMS.

Result: Executing the Python script allowed us to inject commands directly into the system as the web user. This enabled us to access the root directory (`/`) and retrieve Flag 1 (`flag1.txt`).

---
### 2. SSH Brute-Force (Flag 2)

User Enumeration: By accessing the file system via the RCE shell, we enumerated the `/home` directory and discovered the user `iamaweakuser`.

Attack: Since SSH (Port 22) was open, we executed a targeted brute-force attack using Hydra against this user, employing a dictionary of common passwords (`unix_passwords.txt`).

Result: We successfully obtained the password and logged in via SSH. Flag 2 (`flag2.txt`) was located in the user's home directory.


---
Host 2: Plugin Flaws and Free Access Accounts (target2.ine.local)
The second host demonstrated that third-party components (plugins) are a critical failure point, often leading to massive data exposure.

### 3. Arbitrary File Read in WordPress Plugin (Flag 3)

Reconnaissance: We identified the WordPress CMS and performed deep directory enumeration (using `Nikto` and `Gobuster`) since wpscan was inconclusive.

Critical Discovery: Directory brute-forcing revealed the `Duplicator plugin`. A `searchsploit` lookup confirmed a known Arbitrary File Read vulnerability for this plugin.

Exploitation with Metasploit: We used the available Metasploit module for this vulnerability `scanner/http/wp_duplicator_file_read`, configuring only the remote IP (`RHOSTS`).

Result: Once the exploit was successful, we could read any file on the system. By setting the `FILEPATH` to `/flag3.txt`, we retrieved Flag 3 from the root directory.

---
### 4. Passwordless User Compromise (Flag 4)
Account Enumeration: Using the arbitrary file read capability, we read the `/etc/passwd` file. This revealed a suspicious user: `iamacrazyfreeuser`, who had a valid `bash` shell.

Security Failure (Passwordless Access): We attempted an SSH connection with this user (`ssh iamacrazyfreeuser@target2.ine.local`) without providing any password.

Result: The SSH connection was established without authentication (due to a critical SSH configuration error). Once logged in, `Flag 4` was secured from the user's home directory.

---
## Key Lessons from the Lab
This CTF underscores the principle that the security chain is only as strong as its weakest link. The most notable security failures were:

Third-Party Security: The exploitation of the Duplicator plugin highlights the extreme risk of running outdated or vulnerable third-party software.

Account Hygiene: The successful brute-force of iamaweakuser and, even worse, the passwordless SSH access granted to iamacrazyfreeuser, point to critically poor account and permission management. Never should a service user be allowed to authenticate without credentials.