---
title: Post-Exploitation - CTF
date: 2025-09-29 12:10:12 +/-TTTT
categories: [INE, Ejptv2]
tags: [Nmap, ]     # TAG names should always be lowercase


description: Escalate privileges, pivot through the network, and move laterally to compromise other systems.

#toc: false
---

![img-description](/assets/img/Posts/ine.png)


## CTF Solved: Post-Exploitation CTF 
The goal is to escalate privileges, pivot through the network, and move laterally to compromise other systems, demonstrating a deep understanding of the techniques used in a real-world intrusion

---
### 1. Initial Compromise and First Flag (Flag 1)
User Enumeration: An insecure user named `alice` was identified on the system.

Brute-Force Attack: The Hydra tool was used to perform a brute-force attack against the SSH service.

Access and First Flag: `Alices` password was discovered to be `princess1`. Upon logging in via SSH, the first flag (`flag1.txt`) was found in the user's home directory.

---
### 2. Lateral Movement and Second Flag (Flag 2)
Credential Discovery: In `Alices` directory, a file named `hashdump.txt` was found, containing password hashes of other system users.

Hash Cracking: The file was copied to the local machine, and the John the Ripper tool was used to crack the NTLM hashes.

Access and Second Flag: The password for the user `david` was obtained, and a new SSH session was initiated with his credentials. The second flag (`flag2.txt`) was found in his home directory.

---
### 3. Privilege Escalation and Third Flag (Flag 3)
Privilege Identification: The privileges of the user `david` were checked with the `whoami /priv` command, and it was discovered that he had the `SeImpersonatePrivilege`.

Exploitation with PrintSpoofer: The `PrintSpoofer64.exe` executable was transferred to the compromised machine via SCP. This tool exploits the Print Spoofer service to escalate privileges.

Execution and Third Flag: By executing the command `PrintSpoofer64.exe -i -c cmd`, a command shell with elevated privileges (`NT AUTHORITY\SYSTEM`) was obtained. The third flag was found and read in the `C:\Windows\System32\config` directory.

---
### 4. Searching for the Fourth Flag (Flag 4)
Administrator Directory Access: With `SYSTEM` privileges, an attempt was made to access the `Administrator` home directory to find the last flag.

Identifying Restrictive Permissions: Access was denied due to restrictive permissions. The `icacls flag` command was used to view the Access Control List (ACL), which revealed a `deny` rule for `NT AUTHORITY\SYSTEM`.

Permission Modification and Fourth Flag: The deny rule was removed with `icacls flag /remove:d "NT AUTHORITY\SYSTEM"`. Once the permissions were changed, the directory could be accessed, and the final flag was read.

---
### Conclusion
This lab is a clear demonstration that the post-exploitation phase is just as critical as the initial access. It teaches you to think like a persistent attacker, one who doesn't stop at a single system. The ability to perform thorough internal enumeration, methodically escalate privileges, and, most importantly, pivot through the network are indispensable skills. Completing this CTF not only validates theoretical knowledge but also reinforces the practical process of how an intrusion extends beyond the first entry point. It is a crucial step on the path to mastering offensive security.